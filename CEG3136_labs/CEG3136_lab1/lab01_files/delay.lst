C:\Users\bthal\Desktop\delay.lst - generated by MGTEK Assembler ASM12 V1.26 Build 144 for WIN32 (x86) - Sun Sep 29 18:55:12 2019

    1:                                 ;------------------------------------------------------
    2:                                 ; Alarm System Simulation Assembler Program
    3:                                 ; File: delay.asm
    4:                                 ; Description: The Delay Module
    5:                                 ; Author: Gilbert Arbez
    6:                                 ; Date: Fall 2010
    7:                                 ;------------------------------------------------------
    8:                                 
    9:                                 ; Some definitions
   10:                                 
C:\Users\bthal\Desktop\delay.asm(11): Error A2063: col(10) 'code_section': section not defined
   11:                                   SWITCH code_section
   12:                                 
   13:                                 ;------------------------------------------------------
   14:                                 ; Subroutine setDelay
   15:                                 ; Parameters: cnt - accumulator D
   16:                                 ; Returns: nothing
   17:                                 ; Global Variables: delayCount
   18:                                 ; Description: Intialises the delayCount 
   19:                                 ;              variable.
   20:                                 ;------------------------------------------------------
   21:     0000                        setDelay: 
   22:                                 
   23:                                    ; Complete this subroutine
   24:     0000 5C 1F                          STD delayCount ; store delayCount in accumulator
   25:                                 
   26:                                 
   27:     0002 3D                        rts
   28:                                 
   29:                                 
   30:                                 ;------------------------------------------------------
   31:                                 ; Subroutine: polldelay
   32:                                 ; Parameters:  none
   33:                                 ; Returns: TRUE when delay counter reaches 0 - in accumulator A
   34:                                 ; Local Variables
   35:                                 ;   retval - acc A cntr - X register
   36:                                 ; Global Variables:
   37:                                 ;      delayCount
   38:                                 ; Description: The subroutine delays for 1 ms, decrements delayCount.
   39:                                 ;              If delayCount is zero, return TRUE; FALSE otherwise.
   40:                                 ;   Core Clock is set to 24 MHz, so 1 cycle is 41 2/3 ns
   41:                                 ;   NOP takes up 1 cycle, thus 41 2/3 ns
   42:                                 ;   Need 24 cyles to create 1 microsecond delay
   43:                                 ;   8 cycles creates a 333 1/3 nano delay
   44:                                 ;       DEX - 1 cycle
   45:                                 ;       BNE - 3 cyles - when branch is taken
   46:                                 ;       Need 4 NOP
   47:                                 ;   Run Loop 3000 times to create a 1 ms delay   
   48:                                 ;------------------------------------------------------
   49:                                 ; Stack Usage:
   50:                                         OFFSET 0  ; to setup offset into stack
   51:     0000                        PDLY_VARSIZE:
   52:     0000 +0002                  PDLY_PR_Y   DS.W 1 ; preserve Y
   53:     0002 +0002                  PDLY_PR_X   DS.W 1 ; preserve X
   54:     0004 +0001                  PDLY_PR_B   DS.B 1 ; preserve B
   55:     0005 +0002                  PDLY_RA     DS.W 1 ; return address
   56:                                 
   57:     0003 37                       polldelay:  pshb
   58:     0004 34                       pshx
   59:     0005 35                       pshy
   60:                                 
   61:                                 
   62:                                         ; Complete this routine
   63:                                 
C:\Users\bthal\Desktop\delay.asm(64): Error A2038: col(15) 'false': undefined symbol
   64:                                         LDAA #FALSE
   65:     0006 CE 0BB8                        LDX #3000
   66:                                 
   67:     0009                        timerLoop:  ; check loop that verifies the decrement of the timer using the 1 ms loop delay
   68:     0009 26 02                          BNE delay_loop
   69:     000B 27 07                          BEQ endLoop
   70:                                 
   71:     000D                        delay_loop:  ; small loop that implements a 1ms counter using clock speed (24 clock cycles : 1 millisecond)
   72:     000D A7                             NOP
   73:     000E A7                             NOP
   74:     000F A7                             NOP
   75:     0010 A7                             NOP
   76:     0011 09                             DEX
   77:     0012 20 F5                          BRA timerLoop
   78:                                   ; end of 1 MS delay loop
   79:                                 
   80:     0014                        endLoop:  ; decrement delayCount commands, this is the loop that will terminate the timer cycle at the end of the preset time.
   81:     0014 DD 1F                          LDY delayCount  
   82:     0016 03                             DEY
   83:     0017 5D 1F                          STY delayCount
   84:     0019 26 00                          BNE return_from_poll_delay
C:\Users\bthal\Desktop\delay.asm(85): Error A2038: col(14) 'true': undefined symbol
   85:                                         LDAA #TRUE
   86:                                 
   87:     001B                        return_from_poll_delay:
   88:                                    ; restore registers and stack
   89:     001B 31                        puly
   90:     001C 30                        pulx
   91:     001D 33                        pulb
   92:     001E 3D                        rts
   93:                                 
   94:                                 
   95:                                 
   96:                                 ;------------------------------------------------------
   97:                                 ; Global variables
   98:                                 ;------------------------------------------------------
C:\Users\bthal\Desktop\delay.asm(99): Error A2063: col(11) 'globalvar': section not defined
   99:                                    switch globalVar
  100:     001F +0002                  delayCount ds.w 1   ; 2 byte delay counter

Symbols:
delay_loop                      *0000000d
delaycount                      *0000001f
endloop                         *00000014
false                           ?00000000
return_from_poll_delay          *0000001b
timerloop                       *00000009
true                            ?00000000

